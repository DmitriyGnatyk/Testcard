<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEO HUD // BASS LOCK</title>
    <!-- Іконки та шрифти -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Aldrich&family=Rajdhani:wght@300;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #030405;
            font-family: 'Rajdhani', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #c0f0f0;
            overflow-x: hidden;
            position: relative;
        }

        /* Глітч-підкладка (сітка) */
        .grid-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(0, 255, 255, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 255, 0.02) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            z-index: 0;
        }

        /* Прелоудер — калібрування HUD */
        #hud-splash {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #020208;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s, visibility 0.8s;
            border: 3px solid #0ff;
            box-shadow: inset 0 0 150px #0ff2;
            backdrop-filter: blur(5px);
        }

        .calibration-panel {
            max-width: 650px;
            width: 90%;
            background: rgba(0, 10, 10, 0.5);
            border: 2px solid #0ff;
            padding: 30px;
            box-shadow: 0 0 70px #0ff;
            backdrop-filter: blur(15px);
        }

        .hud-line {
            font-family: 'Aldrich', monospace;
            font-size: 1.5rem;
            color: #0ff;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #0ff3;
            padding-bottom: 8px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #021010;
            border: 1px solid #0ff;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            width: 0%;
            height: 100%;
            background: #0ff;
            box-shadow: 0 0 30px cyan;
            transition: width 0.2s;
        }

        .blink-cursor {
            display: inline-block;
            width: 20px;
            height: 30px;
            background: #0ff;
            animation: blink 1s step-end infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* Головний HUD (прихований) */
        #hud-main {
            position: relative;
            z-index: 100;
            width: 100%;
            max-width: 1200px;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.7s, visibility 0.7s;
            pointer-events: none;
        }

        #hud-main.visible {
            opacity: 1;
            visibility: visible;
            pointer-events: all;
        }

        /* ХАД-панель */
        .hud-container {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 20px;
            align-items: center;
        }

        /* ліва панель (метрики) */
        .metrics-panel {
            background: rgba(0, 5, 8, 0.7);
            backdrop-filter: blur(20px);
            border: 2px solid #0ff;
            padding: 25px 15px;
            box-shadow: 0 0 50px #0ff3, inset 0 0 30px #0ff1;
            border-radius: 10px;
        }

        .metric-item {
            margin: 25px 0;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #8ff;
            letter-spacing: 2px;
            text-transform: uppercase;
            display: flex;
            justify-content: space-between;
        }

        .metric-bar-bg {
            width: 100%;
            height: 12px;
            background: #011;
            border: 1px solid #0ff;
            margin-top: 5px;
        }

        .metric-bar-fill {
            height: 100%;
            width: 20%;
            background: #0ff;
            box-shadow: 0 0 20px cyan;
            transition: width 0.1s;
        }

        /* центральний модуль (аватар + соц іконки) */
        .center-hud {
            background: rgba(0, 8, 12, 0.6);
            backdrop-filter: blur(25px);
            border: 3px solid #0ff;
            border-radius: 50%;
            padding: 15px;
            aspect-ratio: 1/1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 120px #0ff5, inset 0 0 50px #0ff3;
            transition: box-shadow 0.1s, border-color 0.1s;
        }

        .hud-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid #0ff;
            object-fit: cover;
            filter: grayscale(0.5) contrast(1.5);
            box-shadow: 0 0 40px cyan;
            transition: transform 0.1s, filter 0.2s;
        }

        .social-hud {
            display: flex;
            gap: 20px;
            margin-top: 25px;
        }

        .social-hud a {
            color: #0ff;
            font-size: 2rem;
            text-shadow: 0 0 20px cyan;
            transition: 0.15s;
            opacity: 0.8;
        }

        .social-hud a:hover {
            opacity: 1;
            transform: scale(1.2);
            text-shadow: 0 0 40px #0ff, 0 0 80px magenta;
        }

        /* права панель (спектр, баси) */
        .spectrum-panel {
            background: rgba(0, 5, 8, 0.7);
            backdrop-filter: blur(20px);
            border: 2px solid #0ff;
            padding: 25px 15px;
            box-shadow: 0 0 50px #0ff3, inset 0 0 30px #0ff1;
            border-radius: 10px;
            height: 100%;
        }

        .spectrum-visual {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 15px;
        }

        .spectrum-band {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .band-label {
            width: 50px;
            color: #8ff;
            font-size: 0.8rem;
        }

        .band-bar-bg {
            flex: 1;
            height: 18px;
            background: #011;
            border: 1px solid #0ff;
        }

        .band-bar-fill {
            height: 100%;
            width: 0%;
            background: #0ff;
            box-shadow: 0 0 20px cyan;
            transition: width 0.05s;
        }

        .bpm-counter {
            font-size: 2rem;
            font-weight: 700;
            color: #0ff;
            text-shadow: 0 0 30px cyan;
            margin: 20px 0;
            text-align: center;
        }

        audio { display: none; }
    </style>
</head>
<body>
    <div class="grid-overlay"></div>

    <!-- СПЛАШ: КАЛІБРУВАННЯ HUD -->
    <div id="hud-splash">
        <div class="calibration-panel">
            <div class="hud-line">> HUD CALIBRATION v.2.07 <span class="blink-cursor"></span></div>
            <div class="hud-line">> LINKING AUDIO INTERFACE</div>
            <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 0%;"></div></div>
            <div class="hud-line">> BASS DETECTION MODULE <span id="statusText">OFFLINE</span></div>
            <div class="hud-line" style="font-size: 1rem; color: #6ff;">> НАТИСНИ БУДЬ-ДЕ, ЩОБ АКТИВУВАТИ</div>
        </div>
    </div>

    <!-- ГОЛОВНИЙ HUD -->
    <div id="hud-main">
        <div class="hud-container">
            <!-- Ліва панель: метрики -->
            <div class="metrics-panel">
                <div class="metric-item">
                    <div class="metric-label"><span>BASS LEVEL</span> <span id="bassValue">0%</span></div>
                    <div class="metric-bar-bg"><div class="metric-bar-fill" id="bassBar" style="width: 0%;"></div></div>
                </div>
                <div class="metric-item">
                    <div class="metric-label"><span>SUBSONIC</span> <span id="subValue">0%</span></div>
                    <div class="metric-bar-bg"><div class="metric-bar-fill" id="subBar" style="width: 0%;"></div></div>
                </div>
                <div class="metric-item">
                    <div class="metric-label"><span>PUNCH</span> <span id="punchValue">0%</span></div>
                    <div class="metric-bar-bg"><div class="metric-bar-fill" id="punchBar" style="width: 0%;"></div></div>
                </div>
                <div class="metric-item">
                    <div class="metric-label"><span>HZ DROP</span> <span id="dropValue">0</span></div>
                    <div class="metric-bar-bg"><div class="metric-bar-fill" id="dropBar" style="width: 0%;"></div></div>
                </div>
            </div>

            <!-- Центр: аватар + соціальні -->
            <div class="center-hud" id="centerHud">
                <img src="https://i.pravatar.cc/300?img=7" alt="avatar" class="hud-avatar" id="hudAvatar">
                <div class="social-hud">
                    <a href="#"><i class="fab fa-github"></i></a>
                    <a href="#"><i class="fab fa-spotify"></i></a>
                    <a href="#"><i class="fab fa-telegram"></i></a>
                    <a href="#"><i class="fab fa-steam"></i></a>
                </div>
            </div>

            <!-- Права панель: спектр + BPM -->
            <div class="spectrum-panel">
                <div class="bpm-counter" id="bpmDisplay">—</div>
                <div class="spectrum-visual" id="spectrumBars">
                    <!-- генеруємо 6 смуг -->
                </div>
            </div>
        </div>
    </div>

    <audio id="myAudio" loop preload="auto">
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <script>
        (function() {
            // ------ HUD СПЛАШ З АНІМАЦІЄЮ ПРОГРЕСБАРУ ------
            const splash = document.getElementById('hud-splash');
            const mainHud = document.getElementById('hud-main');
            const progressFill = document.getElementById('progressFill');
            const statusText = document.getElementById('statusText');
            const audio = document.getElementById('myAudio');

            let progress = 0;
            const interval = setInterval(() => {
                progress += 2;
                if (progress > 100) progress = 100;
                progressFill.style.width = progress + '%';
                if (progress === 100) {
                    clearInterval(interval);
                    statusText.innerText = 'ONLINE';
                    statusText.style.color = '#0f0';
                }
            }, 40);

            // Клік для старту
            splash.addEventListener('click', async function bootHUD() {
                try {
                    await audio.play();
                } catch (e) { console.warn('audio block'); }
                splash.style.opacity = '0';
                splash.style.visibility = 'hidden';
                mainHud.classList.add('visible');
                if (audio.paused) {
                    // якщо не вдалося, пробуємо ще
                    audio.play().catch(() => {});
                }
                initBassAnalysis();
            });

            // ------ ГЕНЕРАЦІЯ СМУГ СПЕКТРА ------
            const spectrumDiv = document.getElementById('spectrumBars');
            for (let i = 0; i < 6; i++) {
                const band = document.createElement('div');
                band.className = 'spectrum-band';
                band.innerHTML = `
                    <span class="band-label">${i*20+20}Hz</span>
                    <div class="band-bar-bg"><div class="band-bar-fill" id="bandFill${i}" style="width:0%"></div></div>
                `;
                spectrumDiv.appendChild(band);
            }

            // ------ WEB AUDIO (ТІЛЬКИ БАС) ------
            let audioContext, analyser, source;
            const bassBar = document.getElementById('bassBar');
            const bassValue = document.getElementById('bassValue');
            const subBar = document.getElementById('subBar');
            const subValue = document.getElementById('subValue');
            const punchBar = document.getElementById('punchBar');
            const punchValue = document.getElementById('punchValue');
            const dropBar = document.getElementById('dropBar');
            const dropValue = document.getElementById('dropValue');
            const bpmDisplay = document.getElementById('bpmDisplay');
            const centerHud = document.getElementById('centerHud');
            const hudAvatar = document.getElementById('hudAvatar');

            function initBassAnalysis() {
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    analyser = audioContext.createAnalyser();
                    analyser.fftSize = 256;
                    source = audioContext.createMediaElementSource(audio);
                    source.connect(analyser);
                    analyser.connect(audioContext.destination);
                }
                if (audioContext.state === 'suspended') audioContext.resume();

                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);

                function updateHUD() {
                    analyser.getByteFrequencyData(dataArray);

                    // бас = перші 4 біни
                    const bass1 = dataArray[1] || 0;
                    const bass2 = dataArray[2] || 0;
                    const bass3 = dataArray[3] || 0;
                    const sub = dataArray[0] || 0; // інфра-бас
                    
                    const avgBass = (bass1 + bass2 + bass3) / 3;
                    const bassPercent = (avgBass / 255) * 100;
                    const subPercent = (sub / 255) * 100;

                    // оновлення лівих метрів
                    bassBar.style.width = bassPercent + '%';
                    bassValue.innerText = Math.round(bassPercent) + '%';
                    subBar.style.width = subPercent + '%';
                    subValue.innerText = Math.round(subPercent) + '%';

                    // punch (середні)
                    const punch = dataArray[5] || 0;
                    const punchPercent = (punch / 255) * 100;
                    punchBar.style.width = punchPercent + '%';
                    punchValue.innerText = Math.round(punchPercent) + '%';

                    // drop (низькі + випадковість)
                    const dropRand = Math.random() * 20 + bassPercent * 0.6;
                    dropBar.style.width = Math.min(dropRand, 100) + '%';
                    dropValue.innerText = Math.round(bassPercent * 0.8) + ' Hz';

                    // імітація BPM (залежить від басу)
                    const fakeBpm = 80 + Math.round(bassPercent * 1.2);
                    bpmDisplay.innerText = fakeBpm + ' BPM';

                    // оновлення 6 смуг справа
                    for (let i = 0; i < 6; i++) {
                        const val = dataArray[i * 3] || 0;
                        const percent = (val / 255) * 100;
                        const bandFill = document.getElementById(`bandFill${i}`);
                        if (bandFill) bandFill.style.width = percent + '%';
                    }

                    // ЕФЕКТ НА ЦЕНТРАЛЬНОМУ HUD (пульс)
                    const scale = 1 + (bassPercent / 500);
                    centerHud.style.transform = `scale(${scale})`;
                    const glow = 50 + bassPercent * 3;
                    centerHud.style.boxShadow = `0 0 ${glow}px #0ff5, inset 0 0 50px #0ff3`;

                    // глітч-ефект на аватарі (іноді)
                    if (bassPercent > 60 && Math.random() > 0.7) {
                        hudAvatar.style.filter = 'grayscale(1) contrast(2) hue-rotate(90deg)';
                        setTimeout(() => hudAvatar.style.filter = 'grayscale(0.5) contrast(1.5)', 100);
                    }

                    requestAnimationFrame(updateHUD);
                }
                updateHUD();
            }

            // резервний старт по кліку
            document.body.addEventListener('click', function forceOnce() {
                if (splash.style.visibility !== 'hidden' && audio.paused) {
                    splash.click();
                }
            }, { once: true });
        })();
    </script>
</body>
</html>
